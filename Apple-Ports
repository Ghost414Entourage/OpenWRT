https://support.apple.com/en-us/103229





| Port | Type | Service/Protocol | RFC | Service Name | Used By |
|------|------|-------------------|-----|--------------|---------|
| 22 | TCP | Secure Shell (SSH), SSH File Transfer Protocol (SFTP), Secure copy (scp) | 4253 | ssh | Xcode Server (hosted and remote Git+SSH, remote SVN+SSH) |
| 25 | TCP | Simple Mail Transfer Protocol (SMTP) | 5321 | smtp | Mail (sending email), iCloud Mail (sending email) |
| 53 | TCP, UDP | Domain Name System (DNS) | 1034 | domain | — |
| 80 | TCP | Hypertext Transfer Protocol (HTTP) | 2616 | http | World Wide Web, FaceTime, iMessage, iCloud, Maps, Apple Music, iTunes Store, Podcasts, Mac App Store, Backup, Calendar, WebDAV, AirPlay, macOS Internet Recovery, Xcode Server (Xcode app, hosted and remote Git HTTP, remote SVN HTTP) |
| 88 | TCP | Kerberos | 4120 | kerberos | Kerberos, including Screen Sharing authentication |
| 110 | TCP | Post Office Protocol (POP3), Authenticated Post Office Protocol (APOP) | 1939 | pop3 | Mail (receiving email) |
| 123 | UDP | Network Time Protocol (NTP) | 1305 | ntp | Date & Time preferences, network time server synchronization, Apple TV network time server sync |
| 137 | UDP | Windows Internet Naming Service (WINS) | — | netbios-ns | — |
| 138 | UDP | NETBIOS Datagram Service | — | netbios-dgm | Windows Datagram Service, Windows Network Neighborhood |
| 139 | TCP | Server Message Block (SMB) | — | netbios-ssn | File sharing and Windows print services |
| 143 | TCP | Internet Message Access Protocol (IMAP) | 3501 | imap | Mail (receiving email) |
| 192 | UDP | OSU Network Monitoring System | — | osu-nms | AirPort Base Station PPP status or discovery (certain configurations), AirPort Admin Utility, AirPort Express Assistant |
| 389 | TCP | Lightweight Directory Access Protocol (LDAP) | 4511 | ldap | Apps that look up addresses, such as Mail and Address Book |
| 443 | TCP | Secure Sockets Layer (SSL or HTTPS) | 2818 | https | TLS websites, iTunes Store, Software Update, Spotlight Suggestions, Mac App Store, Maps, FaceTime, Game Center, iCloud authentication and DAV Services (Contacts, Calendars, Bookmarks), iCloud backup and apps (Calendars, Contacts, Find My iPhone, Find My Friends, Mail, iMessage, Documents & Photo Stream), iCloud Key Value Store (KVS), AirPlay, macOS Internet Recovery, Dictation, Siri, Xcode Server (hosted and remote Git HTTPS, remote SVN HTTPS, Apple Developer registration), Push notifications (if necessary) |
| 443 | UDP | QUIC | — | https | iCloud Private Relay |
| 445 | TCP | Microsoft SMB Domain Server | — | microsoft-ds | — |
| 465 | TCP | Message Submission for Mail (Authenticated SMTP) | — | urd, smtp (legacy) | Mail (sending mail) |
| 500 | UDP | Wi-Fi Calling | 5996 | isakmp | Wi-Fi Calling |
| 515 | TCP | Line Printer (LPR), Line Printer Daemon (LPD) | — | printer | Printing to a network printer, Printer Sharing in macOS |
| 548 | TCP | Apple Filing Protocol (AFP) over TCP | — | afpovertcp | AppleShare, Personal File Sharing, Apple File Service |
| 554 | TCP, UDP | Real Time Streaming Protocol (RTSP) | 2326 | rtsp | AirPlay, streaming media players |
| 587 | TCP | Message Submission for Mail (Authenticated SMTP) | 4409 | submission | Mail (sending mail), iCloud Mail (SMTP authentication) |
| 631 | TCP | Internet Printing Protocol (IPP) | 2910 | ipp | macOS Printer Sharing, printing to many common printers |
| 636 | TCP | Secure LDAP | — | ldaps | — |
| 749 | TCP, UDP | Kerberos 5 admin/changepw | — | kerberos-adm | — |
| 993 | TCP | Mail IMAP SSL | — | imaps | iCloud Mail (SSL IMAP) |
| 995 | TCP, UDP | Mail POP SSL | — | pop3s | — |
| 1900 | UDP | SSDP | — | ssdp | Bonjour |
| 2197 | TCP | Apple Push Notification Service (APNS) | — | mnp-exchange | Push notifications |
| 3031 | TCP, UDP | Remote AppleEvents | — | eppc | Program Linking, Remote Apple Events |
| 3283 | TCP, UDP | Apple Remote Desktop | — | net-assistant | Apple Remote Desktop |
| 3284 | TCP | Classroom File Transfer | — | 4talk, classroom | Classroom app (document sharing) |
| 3285 | TCP | Classroom | — | plato, classroom | Classroom |
| 3478–3497 | UDP | — | — | nat-stun-port, etc. | FaceTime, Game Center |
| 3689 | TCP | Digital Audio Access Protocol (DAAP) | — | daap | iTunes Music Sharing, AirPlay |
| 3690 | TCP, UDP | Subversion | — | svn | Xcode Server (anonymous remote SVN) |
| 4398 | UDP | — | — | — | Game Center |
| 4500 | UDP | Wi-Fi Calling | 5996 | ipsec-msft | Wi-Fi Calling |
| 5100 | TCP | — | — | socalia | macOS camera and scanner sharing |
| 5223 | TCP | Apple Push Notification Service (APNS) | — | — | iCloud DAV Services (Contacts, Calendars, Bookmarks), Push Notifications, FaceTime, iMessage, Game Center, Photo Stream |
| 5228 | TCP | — | — | — | Spotlight Suggestions, Siri |
| 5297 | TCP | — | — | — | Messages (local traffic) |
| 5350 | UDP | NAT Port Mapping Protocol Announcements | — | — | Bonjour |
| 5351 | UDP | NAT Port Mapping Protocol | — | nat-pmp | Bonjour |
| 5353 | UDP | Multicast DNS (MDNS) | 3927 | mdns | Bonjour, AirPlay, Home Sharing, Printer Discovery |
| 5900 | TCP | Remote Framebuffer | 6143 | rfb | Apple Remote Desktop, Screen Sharing |
| 5900 | UDP | Remote Framebuffer, Real-Time Transport Protocol (RTP), Real-Time Control Protocol (RTCP) | — | rfb | Apple Remote Desktop, Screen Sharing |
| 5901–5902 | UDP | Real-Time Transport Protocol (RTP), Real-Time Control Protocol (RTCP) | — | — | Apple Remote Desktop, Screen Sharing |
| 8000–8999 | TCP | — | — | irdmi, etc. | Web service, iTunes Radio streams |
| 9100 | TCP | Printing | — | hp-pdl-datastr | Printing to certain network printers |
| 9418 | TCP, UDP | git pack transfer | — | git | Xcode Server (remote git) |
| 16384–16403 | UDP | Real-Time Transport Protocol (RTP), Real-Time Control Protocol (RTCP) | — | connected, etc. | Messages (Audio RTP & RTCP, Video RTP & RTCP) |
| 16384–16387 | UDP | Real-Time Transport Protocol (RTP), Real-Time Control Protocol (RTCP) | — | connected, etc. | FaceTime, Game Center |
| 16393–16402 | UDP | Real-Time Transport Protocol (RTP), Real-Time Control Protocol (RTCP) | — | connected, etc. | FaceTime, Game Center |
| 16403–16472 | UDP | Real-Time Transport Protocol (RTP), Real-Time Control Protocol (RTCP) | — | — | Game Center |
| 42000–42999 | TCP | — | — | — | iTunes Radio streams |
| 49152–65535 | TCP | Xsan | — | — | Xsan Filesystem Access |




//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


# Flush existing rules in the PREROUTING chain of the RAW table
iptables -t raw -F PREROUTING

# Set a general policy to DROP for specific ports
iptables -t raw -A PREROUTING -p tcp --dport 22 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 22 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 25 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 25 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 53 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 53 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 53 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 53 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 80 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 80 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 88 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 88 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 110 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 110 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 123 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 123 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 137 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 137 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 138 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 138 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 139 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 139 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 143 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 143 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 192 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 192 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 389 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 389 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 443 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 443 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 443 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 443 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 445 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 445 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 465 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 465 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 500 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 500 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 515 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 515 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 548 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 548 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 554 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 554 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 554 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 554 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 587 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 587 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 631 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 631 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 636 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 636 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 749 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 749 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 749 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 749 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 993 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 993 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 995 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 995 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 995 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 995 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 1900 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 1900 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 2197 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 2197 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 3031 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 3031 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3031 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3031 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 3283 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 3283 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3283 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3283 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 3284 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3284 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 3285 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3285 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 3478:3497 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3478:3497 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 3689 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3689 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 3690 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 3690 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 3690 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 3690 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 4398 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 4398 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 4500 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 4500 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 5100 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 5100 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 5223 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 5223 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 5228 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 5228 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 5297 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 5297 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 5350 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 5350 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 5351 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 5351 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 5353 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 5353 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 5900 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 5900 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 5900 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 5900 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 5901:5902 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 5901:5902 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 8000:8999 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 8000:8999 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 9100 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 9100 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 9418 -j DROP
iptables -t raw -A PREROUTING -p udp --dport 9418 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 9418 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 9418 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 16384:16403 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 16384:16403 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 16384:16387 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 16384:16387 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 16393:16402 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 16393:16402 -j DROP

iptables -t raw -A PREROUTING -p udp --dport 16403:16472 -j DROP
iptables -t raw -A PREROUTING -p udp --sport 16403:16472 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 42000:42999 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 42000:42999 -j DROP

iptables -t raw -A PREROUTING -p tcp --dport 49152:65535 -j DROP
iptables -t raw -A PREROUTING -p tcp --sport 49152:65535 -j DROP






//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////




